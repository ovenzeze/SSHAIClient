### **文档一：需求文档 (Requirements Document)**

**Document Title:** Requirements Document for AI-Enhanced iOS SSH Client
**Version:** 1.0
**Date:** 2025-09-03
**Author:** Gemini AI Assistant

---

#### **修订历史 (Revision History)**

| Version | Date       | Author                | Changes Description |
| :------ | :--------- | :-------------------- | :------------------ |
| 1.0     | 2025-09-03 | Gemini AI Assistant | Initial draft       |

---

### **1. 引言 (Introduction)**

#### **1.1. 项目目标 (Project Goal)**

本项目的核心目标是开发一款专为移动端优化的、基于人工智能的 SSH 客户端。该产品旨在解决移动设备上 SSH 操作输入成本高、上下文切换频繁、错误排查低效的核心痛点，通过 AI 赋能，显著提升开发者与系统管理员在移动场景下的工作效率和操作体验。

#### **1.2. 产品定位 (Product Positioning)**

*   **定位**: 一款智能、安全、高效的 iOS SSH 客户端，是开发者的移动生产力工具。
*   **核心差异化**:
    *   **智能交互**: 自动识别用户意图（命令 vs. 对话），简化输入。
    *   **隐私优先**: 采用本地优先的数据架构，最大化保护用户数据安全。
    *   **移动优化**: 深度优化的 AI 交互模式，专为触控屏设计。
    *   **生态系统**: 提供丰富的一键式脚本库，简化重复性任务。
    *   **原生集成**: 深度集成 Zsh/Tmux 等高级终端特性。

#### **1.3. 目标用户 (Target Audience)**

| 用户群体 (User Group)                    | 占比 (Percentage) | 核心场景 (Key Scenarios)                                                              |
| :--------------------------------------- | :---------------- | :------------------------------------------------------------------------------------ |
| Developers & System Administrators     | 60%               | 移动办公时的服务器维护、故障排查、日志查看、系统监控。                      |
| DevOps Engineers                       | 25%               | 紧急的临时部署、快速配置变更、CI/CD 流程监控。                            |
| HomeLab Enthusiasts & Tech Practitioners | 15%               | 个人服务器管理、技术探索、学习和调试。                                      |

---

### **2. 核心功能需求 (Core Functional Requirements)**

#### **2.1. MVP 1: 智能意图路由与自然语言转命令 (Auto Mode Intent Routing & NL2CLI)**

*   **REQ-F-001**: 系统必须提供一个统一的输入接口，能够自动区分用户的输入是可直接执行的 Shell 命令还是需要 AI 理解的自然语言查询。
*   **REQ-F-002**: 对于自然语言查询，系统应能将其转换为一个或多个准确、安全的 Shell 命令（NL2CLI）。
*   **REQ-F--003**: AI 生成的命令在执行前，必须向用户提供一个安全预览界面，清晰展示待执行的命令、命令解释及潜在风险等级。
*   **REQ-F-004**: 用户应能一键接受并执行 AI 建议的命令，或选择复制、编辑该命令。
*   **REQ-F-005**: 所有执行的命令（无论是用户输入还是 AI 生成）都必须被记录在历史中，并明确标识其来源。

#### **2.2. MVP 2: 智能错误诊断与修复 (Error-Aware Auto-Dialogue & Fix)**

*   **REQ-F-006**: 系统必须能够实时检测命令执行的失败（例如，非零退出码、标准错误输出）。
*   **REQ-F-007**: 当命令执行失败时，系统应自动触发 AI 对话，分析错误原因，并提供一个或多个具体的修复建议。
*   **REQ-F-008**: 用户应能通过简单的交互（如点击按钮）一键应用 AI 提供的修复方案。
*   **REQ-F-009**: 系统应在本地建立一个错误模式知识库，通过学习用户的成功修复案例，持续提升建议的准确性。

#### **2.3. MVP 3: 智能会话摘要与报告 (Session Summary, Audit & Sharing)**

*   **REQ-F-010**: 系统必须能够根据时间间隔、目录切换、关键命令等因素，自动将一个长的 SSH 会话分割成多个逻辑操作块。
*   **REQ-F-011**: 系统应能为每个会话或逻辑操作块自动生成简洁、准确的摘要。
*   **REQ-F-012**: 用户应能将完整的会话记录或摘要一键导出为 Markdown 格式的报告。
*   **REQ-F-013**: 在生成报告时，系统必须提供自动脱敏功能，识别并隐藏密码、密钥、IP 地址等敏感信息。
*   **REQ-F-014**: 用户应能生成会话报告的只读分享链接，方便团队成员之间进行审计和知识共享。

---

### **3. 辅助功能需求 (Auxiliary Functional Requirements)**

#### **3.1. 连接管理 (Connection Management)**

*   **REQ-F-015**: 用户能够配置和保存多个 SSH 服务器的连接信息（主机、端口、用户名、认证方式）。
*   **REQ-F-016**: 用户的认证凭据（密码、私钥）必须安全地存储在设备的 Keychain 中。
*   **REQ-F-017**: 应用需提供连接状态的实时监控，并在网络中断后支持自动重连。
*   **REQ-F-018**: 应用需支持基础的端口转发和隧道管理功能。

#### **3.2. 终端增强 (Terminal Enhancement)**

*   **REQ-F-019**: 应用必须集成一个高性能、兼容性好（如 VT100/xterm）的终端模拟器，推荐使用 `SwiftTerm`。
*   **REQ-F-020**: 应用需原生支持 `Zsh` 和 `Oh-My-Zsh`，为用户提供现代化的 Shell 体验。
*   **REQ-F-021**: 应用需支持 `Tmux` 会话管理，包括分屏和多窗口操作。
*   **REQ-F-022**: 用户可以自定义终端的主题（颜色方案）和字体。

#### **3.3. 脚本库 (Script Library)**

*   **REQ-F-023**: 应用需内置一组覆盖常见运维场景的脚本模板（支持 Shell, Python, TypeScript）。
*   **REQ-F-024**: 用户能够创建、编辑和保存自己的脚本，并支持参数化执行。
*   **REQ-F-025**: （远期）建立社区脚本市场，允许用户分享、下载和评价脚本。

#### **3.4. 设置与同步 (Settings & Sync)**

*   **REQ-F-026**: 用户的连接配置和偏好设置应能通过 iCloud 在其所有设备间自动同步。
*   **REQ-F-027**: 提供应用数据（连接、脚本）的手动导入和导出功能。
*   **REQ-F-028**: 提供详细的隐私和安全设置选项，允许用户控制 AI 功能的数据使用范围。

---

### **4. 非功能性需求 (Non-Functional Requirements)**

*   **REQ-NF-001 (性能 Performance)**:
    *   应用冷启动时间应不多于 2 秒。
    *   终端滚动和渲染必须流畅，无明显卡顿。
    *   AI 功能响应时间（本地）应在 1 秒内，（远程）应在 3 秒内。
*   **REQ-NF-002 (安全性 Security)**:
    *   与后端服务的所有通信必须使用 HTTPS 加密。
    *   敏感数据（凭据、私钥）严禁在本地明文存储或传输。
    *   AI 生成的命令必须经过风险评估，高风险命令需用户二次确认。
*   **REQ-NF-003 (隐私 Privacy)**:
    *   核心 AI 功能应优先使用设备端计算（Core ML, Apple Intelligence）。
    *   当需要使用云端 AI 服务时，必须明确告知用户，并提供关闭选项。
    *   用户终端的输入输出数据默认不上传至任何服务器，除非用于用户主动发起的 AI 查询。
*   **REQ-NF-004 (可用性 Usability)**:
    *   UI 设计必须遵循苹果的《Human Interface Guidelines》。
    *   核心操作路径应尽可能短，交互逻辑清晰易懂。
    *   应用需完美适配 iPhone 和 iPad，支持横竖屏及分屏模式。
